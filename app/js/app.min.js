var crmapp=angular.module("crmapp",["ngRoute","Services","ngSanitize","ngCookies","directives","Controllers","textAngular"]);crmapp.config(["$routeProvider",function(a){a.when("/login",{templateUrl:"partials/login.html?v=1.0",controller:"LoginCtrl"}).when("/dashboard",{templateUrl:"partials/dashboard.html",controller:"DashboardCtrl"}).when("/team",{templateUrl:"partials/team.html",controller:"TeamCtrl"}).when("/teamprofile",{templateUrl:"partials/memberprofile.html",controller:"TeamCtrl"}).when("/client",{templateUrl:"partials/client.html",controller:"ClientCtrl"}).when("/cuser",{templateUrl:"partials/cuser.html",controller:"CuserCtrl"}).when("/cuserprofile",{templateUrl:"partials/cuserprofile.html",controller:"CuserCtrl"}).when("/messaging/:project_id/:channel_id",{templateUrl:"partials/messaging.html",controller:"ChatCtrl"}).when("/pdetails/:project_id",{templateUrl:"partials/pdetails.html",controller:"ProjectCtrl"}).when("/keybox/:project_id",{templateUrl:"partials/keybox.html",controller:"KeyboxCtrl"}).when("/stories/:project_id/:ticket_id",{templateUrl:"partials/stories.html",controller:"StoriesCtrl"}).when("/acceptcontract/:cid",{templateUrl:"partials/terms.html",controller:"ContractCtrl"}).when("/clientprojects/:cid",{templateUrl:"partials/clientprojects.html",controller:"ClientProjectsCtrl"}).when("/report/:project_id/:pname",{templateUrl:"partials/hourreports.html",controller:"ReportCtrl"}).when("/invoice",{templateUrl:"partials/invoice.html",}).otherwise({redirectTo:"/dashboard"})}]);crmapp.run(["$rootScope","$location","Login","Chat","$templateCache",function(b,e,c,d,a){b.$on("$routeChangeStart",function(f){window.Intercom("update");if(!c.getLoggedUser()){if(e.path()=="/login"){return}else{e.path("/login")}}else{if(c.getLoggedUser().userinfo.roles[0]=="ROLE_CUSTOMER"||c.getLoggedUser().userinfo.roles[0]=="ROLE_CUSER"){window.Intercom("boot",{app_id:"bf90791k",name:c.getLoggedUser().userinfo.name+" "+c.getLoggedUser().userinfo.surname,email:c.getLoggedUser().userinfo.email,created_at:new Date().getTime()})}c.contractSigned();if(!c.haveAccess()){c.logout(false)}else{if(e.path()=="/login"){e.path("/dashboard");e.replace()}}}if(e.search().last!=undefined){e.url(e.search().last)}})}]);crmapp.filter("toTrusted",function(a){return function b(c,e){e=(((e||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var d=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,f=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return c.replace(f,"").replace(d,function(h,g){return e.indexOf("<"+g.toLowerCase()+">")>-1?h:""})}});